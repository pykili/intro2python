# Что такое Git и зачем он нужен?

## Введение
Git &ndash; это консольная утилита, для отслеживания и ведения истории изменения файлов, в вашем проекте. Чаще всего его используют для кода, но можно и для других файлов. Например, для картинок - полезно для дизайнеров.

С помощью Git-a вы можете откатить свой проект до более старой версии, сравнивать, анализировать или сливать свои изменения в репозиторий.

Репозиторием называют хранилище вашего кода и историю его изменений. Git работает локально и все ваши репозитории хранятся в определенных папках на жестком диске.

Так же ваши репозитории можно хранить и в интернете. Обычно для этого используют три сервиса:
* GitHub
* Bitbucket
* GitLab


Каждая точка сохранения вашего проекта носит название коммит (commit). У каждого commit-a есть hash (уникальный id) и комментарий. Из таких commit-ов собирается ветка. Ветка - это история изменений. У каждой ветки есть свое название. Репозиторий может содержать в себе несколько веток, которые создаются из других веток или вливаются в них.


## Установка Git-а

* Windows
  * [Официальная сборка](https://git-scm.com/download/win) (при установке оставляйте всё дефолтным &ndash; не прогадаете)
* Mac OS
  * нужно попробовать выполнить команду `git --version`. если Git-а нет, то предложит установить
  * но [вот](https://git-scm.com/download/mac) официальная сборка на всякий случай
* Linux
  * `sudo apt install git`

Кроме всего прочего, давайте посмотрим на этот [ресурс](https://githowto.com/setup).

## Оффтоп: базовые консольные команды

* Если у вас Windows, то нужно открыть Git Bash, который мы установили на прошлом шаге (PowerShell НЕ подходит)
* Если у вас Mac или Linux, то нужно открыть терминал

1. `pwd` (print working directory) &ndash; печатает директорию, в которой вы сейчас находитесь
2. `whoami` &ndash; печатает имя текущего пользователя
3. `ls` (**L**i**S**t) &ndash; печатает список не-скрытых файлов и папок в текущей папке
4. `cd TARGET_DIRECTORY` (change directory) &ndash; меняет текущую директорию на `TARGET_DIRECTORY`, которая может записываться относительным путём (`.` = текущая директория) или абсолютным путём.
5. `mkdir DIR_NAME` (make directory) &ndash; создаёт директорию с названием `DIR_NAME`
6. `touch FILE_NAME` &ndash; создаёт файл с названием `FILE_NAME`
7. `cp SOURCE_PATH TARGET_PATH` &ndash; копирует файл
8. `mv SOURCE_PATH TARGET_PATH` &ndash; перемещает файл
9. `rm PATH` &ndash; удаляет файл (чтобы удалить директорию надо добавить флаг `-r` &ndash; `rm -r PATH`)
10. `cat PATH` &ndash; показывает содержимое текстового файла
11. `echo TEXT >> PATH` &ndash; записывает TEXT в ваш файл

## GitHub

[GitHub](https://github.com/) &ndash; это самый популярный ресурс для хранения репозиториев. На нём мы и будем тренироваться.

### Создание репозитория

Чтобы ваш репозиторий оказался в интернете, нужно там его создать.
1. Зайдите на гитхаб, залогиньтесь там
2. В верхнем правом углу нажмите на плюсик > New repository
3. Введите название
4. Давайте пока сделаем публичный репозиторий, а не приватный
5. Зелёная кнопка Create repository

Теперь у вас есть репозиторий и у него есть адрес в адресной строке. Давайте научимся делать так, чтобы этот репозиторий оказался у вас на компьютере.

### Клонирование репозитория

1. Создайте у себя на компьютере папку, в которой будете работать. Сделайте это в каком-нибудь месте, где точно не будет проблем с записью новых файлов (например, на рабочем столе).
2. Откройте в этой папке терминал/GitBash. Если не получается открыть из папки, то просто запустите приложение и перейдите в нужную папку с помощью `cd`.
3. Склонируйте репозиторий. Для этого введите команду `git clone АДРЕС_ВАШЕГО_РЕПОЗИТОРИЯ`. `git clone` по дефолту создаёт папку с названием вашего репозитория в текущей директории и кладёт в неё всё содержимое. Это поведение можно изменить: `git clone АДРЕС_ВАШЕГО_РЕПОЗИТОРИЯ ПУТЬ_К_ПУСТОЙ_ПАПКЕ`.
4. Гит предупредит вас о том, что вы склонировали пустой репозиторий.
5. Выберите любой не-пустой репозиторий на гитхабе и попробуйте его склонировать, проверьте, что всё получилось.

### Что внутри?

1. Перейдите в папку с вашим репозиторием из терминала (команда `cd НАЗВАНИЕ_ПАПКИ`)
2. Проверьте содержимое с помощью команды `ls` (должно быть пусто)
3. Проверьте содержимое с помощью команды `ls -a`: что вы увидели? Как вы думаете, что это такое?

### Добавление файлов в репозиторий

1. Создайте текстовый файл с произвольным названием
2. Напишите в него что-нибудь
3. Напишите `git status`, появится что-то такое:
```console
$ git status
On branch main

No commits yet

Untracked files:
  (use "git add <file>..." to include in what will be committed)
        1.txt

nothing added to commit but untracked files present (use "git add" to track)
```
4. Чтобы добавить файл которые вы создали нужно написать `git add НАЗВАНИЕ_ФАЙЛА`
5. Снова напишите `git status`
```console
$ git status
On branch main

No commits yet

Changes to be committed:
  (use "git rm --cached <file>..." to unstage)
        new file:   1.txt
        
```
6. Попробуйте создать файл, который будет называться `мой файл.txt`. И добавьте его с помощью `git add`. Как это сделать?
7. Попробуйте создать папку и создать в ней несколько файлов. Как их добавить с помощью `git add`?
8. Найдите в интернете способ добавить сразу все файлы с помощью `git add`

Что делает `git add`? Он делает так, чтобы git индексировал файлы (знал про них) и мог с ними как-то работать.

### Коммит

Уже несколько раз мы видели слово commit, но ещё ни разу его не использовали сами. Коммит &ndash; это такая контрольная точка, если после него что-то пойдёт не так, мы откатиться то него. Коммиты &ndash; это главный инструмент контроля версий.

Чтобы сделать коммит, нужно написать `git commit -m "краткое описание коммита"`. Не забывайте добавлять флаг `-m` (message), иначе вас выкинет в текстовый редактор в консоли, которым вы скорее всего не умеете пользоваться.

Если же вы забыли про флаг `-m`, то вас должно перебросить в vim и будет что-то такое:

```vim
 
# Please enter the commit message for your changes. Lines starting
# with '#' will be ignored, and an empty message aborts the commit.
#
# On branch main
# Your branch is ahead of 'origin/main' by 2 commits.
#   (use "git push" to publish your local commits)
#
# Changes to be committed:
#       new file:   my_file.txt
#
~
~
```

Для того, чтобы выйти отсюда, надо:
1. нажать `I` на клавиатуре, чтобы перейти в режим ввода (внизу появится `-- INSERT --`);
2. ввести краткое описание вашего комита в первой строчке
3. нажать `Esc` на клавиатуре, чтобы выйти из режима ввода
4. ввести `:wq` (введется внизу, где раньше появился `-- INSERT --`), что значит **w**rite and **q**uit.
5. нажать  `Enter` на клавиатуре
6. вы прекрасны (и вернулись в git bash)

Сделав коммит вы создали контрольную точку, но только у себя на компьютере. Информация об этом коммите появилась в скрытой папке `.git`, но больше об этом никто не знает. Зачем же мы тогда сделали репозиторий в интернете?

### Push

Чтобы информация о коммите дошла до его оригинального источника в интернете, нужно запушить коммит(ы). Сделать это легко: `git push`.
Если вы делаете это первый раз, то git попросит вас авторизироваться:
1. Нужно будет выполнить две команды. Эти команды показывают, какое имя и какой адрес электронной почты будут отображаться на ваших коммитах.
```console
$ git config --global user.name "John Doe"
$ git config --global user.email johndoe@example.com
```
2. Во время пуша он ещё попросит у вас логин и пароль. ПАРОЛЬ ЭТО НЕ ПАРОЛЬ, это особый токен. Инструкция о том, где его взять, находится [тут](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens).
3. После того, как вы всё введёте, случится пуш и ваши коммиты окажутся в интернете.
4. Откройте страницу с вашим репозиторием на гитхабе, проверьте коммиты.

### Доступ к репо из разных источников

Вы можете редактировать свой репозиторий через сайт гитхаба (вы это наверняка делали во время части про Лингвистические данные).

1. Создайте новый файл через сайт.
2. Убедитесь, что он не появился у вас в папке.
3. Напишите в терминале команду `git pull`. Она подтянет все изменения из оригинального репозитория.


## Выше было введение, теперь рассмотрим коллективную работу


Ветка &ndash; это набор коммитов, которые идут друг за другом. У ветки есть название, основную ветку чаще всего называют master или main ([Почему master повсеместно заменяется на main?](https://habr.com/ru/news/t/506876/)). Если говорить простыми словами, то ветка master &ndash; это наш проект.

Другие ветки &ndash; это отдельное место для реализации нового функционала или исправление багов нашего проекта. То есть, с отдельной веткой вы делаете что угодно, а затем сливаете эти изменения в основную ветку master.

--------------------------------------------------------------------------------
Не рекомендуется создавать commit напрямую в master . Лучше для этого заводить новую ветку и все изменения писать там.
--------------------------------------------------------------------------------


Для того, чтобы создать новую ветку вводим:

```console
git branch <название_ветки>
```

или вот так

```console
git checkout -b <название_ветки>
```

Эти команды делают тоже самое, только второй вариант позволяет сразу переключиться в новую ветку. Вносить изменения в новую ветку можно сразу после ее создания.


При создании новой ветки, старайтесь называть ее кратким и ёмким именем. Чтобы сразу было понятно, что именно изменялось по проекту. Если вы используете, какую-нибудь систему для ведения задач, то можете в начале названия ветки указывать ID задачи, чтобы можно было легко найти, на основе какой задачи была создана ветка. Например вот так:

`dev-3334_fix_catalog_endpoints`


Для того чтобы посмотреть текущее состояние ветки, например, какие файлы добавлены или не добавлены для создания commit, можно выполнить команду:
```console
git status
```

После того, как завершили работу над своей задачей, ветку можно слить в `master`/`main`. Для этого нужно сделать `git merge`, но об этом отдельно.

----------------------------------------------------------------------
Теперь склонировать репозитрий ещё раз и смоделировать как происходила бы работа вдвоем, коммитя в две директории на локальном компе
----------------------------------------------------------------------


Вспомогательные команды
Просмотреть изменения относительно двух веток можно командой:
```console
git diff <исходная_ветка> <целевая_ветка>
```

Удалить ненужную ветку:
```console
git branch -d <название_ветки>
```

Просмотр историю ветки:
```console
git log
```

Команды, которые надо знать
* git help
* git clone
* git status
* git branch
* git checkout
* git merge
* git remote
* git push
* git pull
